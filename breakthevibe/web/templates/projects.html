{% extends "base.html" %}
{% block title %}Projects â€” BreakTheVibe{% endblock %}
{% block content %}
<div class="page-header">
    <h1>Projects</h1>
    <button class="btn btn-primary" onclick="document.getElementById('new-project-form').style.display='block'">
        + New Project
    </button>
</div>

<form id="new-project-form" style="display:none" class="card"
      hx-post="/api/projects" hx-target="#project-grid" hx-swap="beforeend"
      hx-on::after-request="this.reset(); this.style.display='none'; location.reload()">
    <h3>Create Project</h3>
    <label>Name <input type="text" name="name" required minlength="1"></label>
    <label>URL <input type="url" name="url" required placeholder="https://example.com"></label>
    <div class="form-actions">
        <button type="submit" class="btn btn-primary">Create</button>
        <button type="button" class="btn" onclick="this.closest('form').style.display='none'">Cancel</button>
    </div>
</form>

<div id="project-grid" class="card-grid">
    {% for project in projects %}
    <div class="card" id="project-{{ project.id }}">
        <h3>{{ project.name }}</h3>
        <p class="text-muted">{{ project.url }}</p>
        <span class="badge badge-{{ project.status }}">{{ project.status }}</span>
        <div class="card-actions">
            <a href="/projects/{{ project.id }}" class="btn btn-sm">View</a>
            <button class="btn btn-sm btn-danger"
                    hx-delete="/api/projects/{{ project.id }}"
                    hx-target="#project-{{ project.id }}"
                    hx-swap="outerHTML"
                    hx-confirm="Delete this project?">Delete</button>
        </div>
    </div>
    {% endfor %}
    {% if not projects %}
    <p class="text-muted">No projects yet. Create one to get started.</p>
    {% endif %}
</div>
{% endblock %}
